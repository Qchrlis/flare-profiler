(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8b502488"],{"268f":function(t,e,a){t.exports=a("fde4")},"32a6":function(t,e,a){var n=a("241e"),s=a("c3a1");a("ce7e")("keys",function(){return function(t){return s(n(t))}})},"35b4":function(t,e,a){"use strict";var n=a("82bd"),s=a.n(n);s.a},"454f":function(t,e,a){a("46a7");var n=a("584a").Object;t.exports=function(t,e,a){return n.defineProperty(t,e,a)}},"46a7":function(t,e,a){var n=a("63b6");n(n.S+n.F*!a("8e60"),"Object",{defineProperty:a("d9f6").f})},"82bd":function(t,e,a){},"85f2":function(t,e,a){t.exports=a("454f")},"8aae":function(t,e,a){a("32a6"),t.exports=a("584a").Object.keys},a4bb:function(t,e,a){t.exports=a("8aae")},b8d2:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"session"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.show_flame_graph,expression:"show_flame_graph"}],attrs:{id:"flame_graph"}},[a("el-table",{attrs:{data:t.selectCpuRowArray}},[a("el-table-column",{attrs:{width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.name))])]}}])}),a("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(t){return[a("div",{staticClass:"thread_bar",attrs:{id:"thread_select_cpu_chart_"+t.row.id}})]}}])})],1),a("div",{staticStyle:{"margin-top":"20px"},attrs:{id:"flame_graph_svg"},domProps:{innerHTML:t._s(t.flame_graph_data)}})],1)])},s=[],o=a("cebc"),r=(a("ac6a"),{name:"call",data:function(){return{show_flame_graph:!0,flame_graph_data:"",selectCpuRowArray:[],dataZoomStart:0,dataZoomEnd:10}},computed:{sampleInfo:function(){return this.$store.state.sampleInfo},sessionSampleInfo:function(){return this.$store.state.sessionSampleInfo},exampleInfo:function(){return this.$store.state.exampleInfo},sessionId:function(){return this.$route.params.sessionInfo},callName:function(){return this.$route.params.call},sessionThreads:function(){return this.$store.state.sessionThreads},sessionCpuTimes:function(){return this.$store.state.sessionCpuTimes},sessionFlameGraph:function(){return this.$store.state.sessionFlameGraph},historySamples:function(){return this.$store.state.historySamples},sessionTabsValue:function(){return this.$store.state.sessionTabsValue},selectCpuRow:function(){return this.$store.state.selectCpuRow},echartsDataZoomPosition:function(){return this.$store.state.echartsDataZoomPosition}},mounted:function(){var t=this;this.$nextTick(function(){t.on_cpu_time_result()})},created:function(){this.getFlameGraphData()},methods:{getFlameGraphData:function(){var t=this;this.sessionFlameGraph.filter(function(e){e.sessionId==t.sessionId&&e.flameGraphList.filter(function(e){e.threadId==t.callName&&(t.flame_graph_data=e.flameGraphData.flame_graph_data)})});this.historySamples.length<=0&&this.$router.push({path:"/samples"});var e=this.selectCpuRow.filter(function(e){if(e.sessionId==t.sessionId)return e});this.selectCpuRowArray=[],e.forEach(function(e){e.selectRow.forEach(function(e){e.threadName==t.callName&&t.selectCpuRowArray.push(e.threadInfo)})})},on_cpu_time_result:function(){var t=this,e=this.sessionCpuTimes.filter(function(e){if(e.sessionId==t.sessionId)return e});if(e.length<=0||this.selectCpuRowArray.length<=0)return!1;var a=e[0].cpuTimeData;if(!a)return!1;var n=this.sessionSampleInfo.filter(function(e){if(e.sessionId==t.sessionId)return e}),s=n[0].sessionSample,o=s.record_start_time,r=s.last_record_time,i=s.unit_time_ms,c=a.filter(function(e){if(e.id==t.selectCpuRowArray[0].id)return e}),u=c[0];if(u.total_cpu_time>0){var f=this.fill_ts_data(u.ts_data,u.start_time,u.end_time,o,r,i),l=this.create_echarts_bar("thread_select_cpu_chart_"+u.id,f,u);l.on("datazoom",function(e){console.log("evt start",e.start,"evt end",e.end);var a=[],n=t.echartsDataZoomPosition.filter(function(e){if(e.sessionId==t.sessionId)return e;a.push(e)}),s=[];n.filter(function(e){e.dataZoomPosition.forEach(function(e){e.threadName!=t.callName&&s.push(e)})});var r={threadName:t.callName,dataZoomStart:e.start,dataZoomEnd:e.end};s.push(r),a.push({sessionId:t.sessionId,dataZoomPosition:s}),console.log("postitionArray",a,"thread",u),t.$store.commit("echarts_dataZoom_position",a);var c=l.getModel().option.xAxis[0],f=o+c.rangeStart*i,d=o+c.rangeEnd*i;console.log("datazoom: thread:",u.id,", index:",c.rangeStart,"-",c.rangeEnd,", time:",f,"-",d),t.update_call_stack_tree(u.id,f,d)})}},update_call_stack_tree:function(t,e,a){var n={cmd:"flame_graph",options:{session_id:this.sessionId,thread_id:t,start_time:e,end_time:a}};this.$webSocket.webSocketSendMessage(JSON.stringify(n))},create_echarts_bar:function(t,e,a){var n=this;if(!e){e=[];for(var s=0;s<3e3;s++)e.push(1e3*Math.random().toFixed(2))}if(!a.hasOwnProperty("id")||void 0==a.id||!("id"in a))return console.log("id为空，",a),!1;var r=this.echartsDataZoomPosition.filter(function(t){if(t.sessionId==n.sessionId)return t});if(r.length>0){var i={};r.filter(function(t){t.dataZoomPosition.forEach(function(t){t.threadName==n.callName&&(i=Object(o["a"])({},t))})}),this.dataZoomStart=0|i.dataZoomStart,this.dataZoomEnd=10|i.dataZoomEnd}var c={dataZoom:[{type:"inside",start:this.dataZoomStart,end:this.dataZoomEnd,moveOnMouseMove:!1,moveOnMouseWheel:!1,zoomOnMouseWheel:!1},{type:"slider",dataBackground:{lineStyle:{color:"#409eff",opacity:1},areaStyle:{color:"#3a8ee6",opacity:.3}},realtime:!1,filterMode:"empty",top:"top",left:"left"}],xAxis:{data:e,show:!1},yAxis:{show:!1},series:[{type:"bar",data:e,large:!0,largeThreshold:50,itemStyle:{color:"#e74911",opacity:0}}]},u=this.$echarts.init(document.getElementById(t));return u.setOption(c),console.log("myChart",u),u},fill_ts_data:function(t,e,a,n,s,o){var r=(e-n)/o,i=(s-a)/o;if(r<1&&i<1)return t;for(var c=[],u=0;u<r;u++)c.push(0);c=c.concat(t);for(u=0;u<i;u++)c.push(0);return c}},watch:{sessionFlameGraph:function(){var t=this;if(this.sessionFlameGraph.length>0)this.sessionFlameGraph.filter(function(e){e.sessionId==t.sessionId&&e.flameGraphList.filter(function(e){e.threadId==t.callName&&(t.flame_graph_data=e.flameGraphData.flame_graph_data)})})},callName:function(){var t=this;this.getFlameGraphData(),this.$nextTick(function(){t.on_cpu_time_result()})}}}),i=r,c=(a("35b4"),a("2877")),u=Object(c["a"])(i,n,s,!1,null,"2c63b527",null);e["default"]=u.exports},bf90:function(t,e,a){var n=a("36c3"),s=a("bf0b").f;a("ce7e")("getOwnPropertyDescriptor",function(){return function(t,e){return s(n(t),e)}})},ce7e:function(t,e,a){var n=a("63b6"),s=a("584a"),o=a("294c");t.exports=function(t,e){var a=(s.Object||{})[t]||Object[t],r={};r[t]=e(a),n(n.S+n.F*o(function(){a(1)}),"Object",r)}},cebc:function(t,e,a){"use strict";var n=a("268f"),s=a.n(n),o=a("e265"),r=a.n(o),i=a("a4bb"),c=a.n(i),u=a("85f2"),f=a.n(u);function l(t,e,a){return e in t?f()(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},n=c()(a);"function"===typeof r.a&&(n=n.concat(r()(a).filter(function(t){return s()(a,t).enumerable}))),n.forEach(function(e){l(t,e,a[e])})}return t}a.d(e,"a",function(){return d})},e265:function(t,e,a){t.exports=a("ed33")},ed33:function(t,e,a){a("014b"),t.exports=a("584a").Object.getOwnPropertySymbols},fde4:function(t,e,a){a("bf90");var n=a("584a").Object;t.exports=function(t,e){return n.getOwnPropertyDescriptor(t,e)}}}]);
//# sourceMappingURL=chunk-8b502488.cda1f461.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9d4fee78"],{"1ec4":function(s,e,t){"use strict";var i=t("872b"),n=t.n(i);n.a},"6edd":function(s,e,t){"use strict";t.r(e);var i=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"cpu_time_content",staticStyle:{width:"100%"}},[t("el-table",{ref:"cpuTable",staticStyle:{cursor:"pointer"},attrs:{data:s.threads,"highlight-current-row":""},on:{"row-click":s.selectCurRow}},[t("el-table-column",{attrs:{width:"400"},scopedSlots:s._u([{key:"default",fn:function(e){return[t("span",[s._v(s._s(e.row.name))])]}}])}),t("el-table-column",{scopedSlots:s._u([{key:"default",fn:function(s){return[t("div",{staticClass:"thread_bar",attrs:{id:"thread_cpu_chart_"+s.row.id}})]}}])})],1)],1)},n=[],o=(t("7f7f"),t("ac6a"),void 0),r={name:"cpu",data:function(){return{threads:[],selected_thread_id:null}},computed:{sampleInfo:function(){return this.$store.state.sampleInfo},sessionSampleInfo:function(){return this.$store.state.sessionSampleInfo},exampleInfo:function(){return this.$store.state.exampleInfo},sessionThreads:function(){return this.$store.state.sessionThreads},sessionId:function(){return this.$route.params.sessionInfo},sessionCpuTimes:function(){return this.$store.state.sessionCpuTimes},historySamples:function(){return this.$store.state.historySamples},sessionTabsValue:function(){return this.$store.state.sessionTabsValue},selectCpuRow:function(){return this.$store.state.selectCpuRow},sessionCallTabs:function(){return this.$store.state.sessionCallTabs}},mounted:function(){var s=this;this.$nextTick(function(){s.on_cpu_time_result()})},created:function(){this.getThreads()},methods:{selectCurRow:function(s,e,t){var i=this,n=this.sessionTabsValue.filter(function(s){if(s.sessionId!=i.sessionId)return s}),o={sessionId:this.sessionId,tabsValue:s.id+""};n.push(o),this.$store.commit("session_tabs_value",n);var r=[],a=this.selectCpuRow.filter(function(e){if(e.sessionId!=i.sessionId)return e;e.selectRow.forEach(function(e){e.threadName!=s.id&&r.push(e)})});r.push({threadName:s.id,threadInfo:s});var u={sessionId:this.sessionId,selectRow:r};a.push(u),this.$store.commit("select_cpu_row",a);var l=[],c={title:s.name,name:s.id+"",router:"/call/"+s.id,closable:!0},h=this.sessionCallTabs.filter(function(e){if(e.sessionId!=i.sessionId)return e;e.callTabs.forEach(function(e){e.name!=s.id&&l.push(e)})});l.push(c);var d={sessionId:this.sessionId,callTabs:l};h.push(d),this.$store.commit("session_call_tabs",h)},select_thread:function(s){this.selected_thread_id=s},getThreads:function(){var s=this;if(this.sessionId&&this.sessionThreads.length>0){var e=this.sessionThreads.filter(function(e){if(e.sessionId==s.sessionId)return e});e.length>0&&(this.threads=e[0].threads)}this.historySamples.length<=0&&this.$router.push({path:"/samples"})},on_cpu_time_result:function(){var s=this,e=this.sessionCpuTimes.filter(function(e){if(e.sessionId==s.sessionId)return e});if(e.length<=0)return!1;console.log("当前cpu time：",e);var t=e[0].cpuTimeData;if(!t)return!1;var i=this.sessionSampleInfo.filter(function(e){if(e.sessionId==s.sessionId)return e}),n=i[0].sessionSample,o=n.record_start_time,r=n.last_record_time,a=n.unit_time_ms;console.log("sess_start_time:",o,"sess_end_time:",r,"unit_time_ms:",a);for(var u=0;u<t.length;u++){var l=t[u];if(l.total_cpu_time>0){var c=this.fill_ts_data(l.ts_data,l.start_time,l.end_time,o,r,a);this.create_echarts_bar("thread_cpu_chart_"+l.id,c)}}},update_call_stack_tree:function(s,e,t){var i={cmd:"flame_graph",options:{session_id:this.sessionId,thread_id:s,start_time:e,end_time:t}};this.$webSocket.webSocketSendMessage(JSON.stringify(i))},create_echarts_bar:function(s,e){if(!e){e=[];for(var t=0;t<3e3;t++)e.push(1e3*Math.random().toFixed(2))}var i={dataZoom:[{type:"inside",start:0,end:0,moveOnMouseMove:!1,moveOnMouseWheel:!1,zoomOnMouseWheel:!1,disabled:!0},{type:"slider",dataBackground:{lineStyle:{color:"#409eff",opacity:1},areaStyle:{color:"#3a8ee6",opacity:.3}},realtime:!1,filterMode:"empty",top:"top",left:"left",fillerColor:"",handleStyle:{opacity:0,shadowBlur:0}}],xAxis:{data:e,show:!1},yAxis:{show:!1},series:[{type:"bar",data:e,large:!0,largeThreshold:50,itemStyle:{color:"#e74911",opacity:0}}]},n=this.$echarts.init(document.getElementById(s));return n.setOption(i),n},fill_ts_data:function(s,e,t,i,n,o){var r=(e-i)/o,a=(n-t)/o;if(r<1&&a<1)return s;for(var u=[],l=0;l<r;l++)u.push(0);u=u.concat(s);for(l=0;l<a;l++)u.push(0);return u}},watch:{$route:function(s,e){(!o.sessionThreads||o.sessionThreads.length<=0)&&o.$router.push("/samples")}}},a=r,u=(t("1ec4"),t("2877")),l=Object(u["a"])(a,i,n,!1,null,"6761f1d2",null);e["default"]=l.exports},"872b":function(s,e,t){}}]);
//# sourceMappingURL=chunk-9d4fee78.b2374237.js.map